from datetime import datetime
import numpy
from win32gui import GetWindowText, GetForegroundWindow
import time

def getActiveWindow():
    currTask = GetWindowText(GetForegroundWindow())
    windowInfo = currTask.split("- ")
    windowInfo = numpy.flipud(windowInfo)
    application = windowInfo[0]
    try:
        appInfo = windowInfo[1]
        #print(appInfo,windowInfo,len(windowInfo))
    except IndexError:
        pass
    if application == "Google Chrome":
        if "YouTube" in appInfo:
            return(appInfo)
        elif "Google Docs" in appInfo:
            return(appInfo)
        else:
            return(application)
    else:
        return(application)

def main():
    while(True):
        print(getActiveWindow())

main()